---
title: 'Устранение ресурсов, блокирующих рендеринг в Angular'
date: 2020-09-13T00:00:00Z
draft: false
tags: ['blog']
author: 'Rustam'
twitter: 'irustm'
---

В разделе «Возможности» вашего отчета Lighthouse перечислены все URL-адреса, блокирующие отрисовку вашей страницы.

Цель состоит в том, чтобы уменьшить влияние этих URL-адресов, блокирующих рендеринг, путем встраивания критических ресурсов в сам html, откладывания некритических ресурсов и удаления всего неиспользуемого.

Какие URL помечаются как блокирующий рендеринг?

`<script>`

- если он находится в заголовке
- если он не имеет аттрибут defer или async

`<link rel="stylesheet">`

- если нет атрибута disabled
- не имеет атрибута media соответствующий устройству пользователя

Если даже ваш внешний css код будет весить 0кб браузер все равно потратит на него время.

Все для того чтобы увеличить результаты FCP (first contentful paint)

Именно над этим хотят сейчас поработать в Angular CLI.

- Загрузку CSS асинхронно в SPA
- встраивания критических CSS в html
- Inline Google Fonts and Icons.

До:

`<link rel="stylesheet" href="styles.css">`

После:

```
<link rel="stylesheet" href="styles.css" media="only x" onload="this.media='all'">
<noscript><link rel="stylesheet" href="styles.css"></noscript>
```

Как же будут выбирать критически важные CSS?

Пока нет достойного решения который бы устраивал в разных режимах, SSR и CSR. Поэтому по поводу идут еще обсуждения, и рассматриваются различные webpack плагины, и даже есть альтернатива всему этому чтобы включить в рутовый AppComponent styles.css. Но болью в этом случае будет с SSR, так как все глобальные стили будут внедрены в html.

Обсудить предложение в [issue](https://github.com/angular/angular-cli/issues/18730)